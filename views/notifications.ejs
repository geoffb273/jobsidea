<header>

<div id="top">
	<form id="search" onsumbit="return false"><input placeholder="Search"></input></form>
	<button onclick="window.location.href='/'">Jobs</button>
	<button onclick="window.location.href='/notifications'">Notifications</button>
	<button onclick="window.location.href='/chats'">Chats</button>
	<button onclick="window.location.href='/profile'">My Profile</button>
	<button onclick="window.location.href='/login'">Log Out</button>
</div>
<p id="test">Hi</p>
<div class="post">
  <table id = "table"></table>
</div>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>
	var username = '<%- username%>'
	var table = document.getElementById("table");
	var count = 0;
	var notifications = []
	var notificationIds = []
	var getNotifications = function() {
		
		$.get("/my-notifications", function(notifications) {
			
			for (var i = 0; i < notifications.length; i++) {
    			var notification = notifications[i];
    			var content = notification.content
    			if (!notificationIds.includes(notification.id)) {
    				notificationIds.push(notification.id);
    				notifications.push(notification)
    				var row = table.insertRow(i);
					var cell1 = row.insertCell(0);
					cell1.innerHTML = content;
    			} else if (notificationIds.indexOf(notification.id) != i) {
    				var row = table.rows[i];
    				row.cells[0].innerHTML = content;
    			}
    		}
		});
		if (notifications.length == 0 && count < 5) {
			setTimeout(getNotifications, 1000);
		} else {
			setTimeout(getNotifications, 60000);
		}
		count += 1;
	}
	getNotifications()
</script>

</header>